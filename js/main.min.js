function displayAlertBox(n,e,o){var t=document.querySelector(".widget-alert-box"),a=t.innerHTML;t.innerHTML="";var i=document.createElement("img");i.src=window.image,i.style.maxWidth="100%",i.classList.add("fade"),t.appendChild(i);let r=new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"});var d=document.createElement("p");d.innerHTML=window.message_template.replace("{pseudo}",n).replace("{message}",e).replace("{amount}",r.format(o/100)),d.style.marginTop="10px",d.classList.add("fade"),t.appendChild(d),setTimeout(function(){i.classList.add("show"),d.classList.add("show")},100);var s=new Audio(window.sound);s.volume=window.sound_volume,s.play(),setTimeout(function(){i.classList.remove("show"),d.classList.remove("show"),s.pause(),s.currentTime=0,setTimeout(function(){t.innerHTML=a},1e3)},window.alert_duration)}function updateDonationBar(){const n=window.currentAmount/100,e=Math.min(100,n/window.goalAmount*100);document.getElementById("goal-current").textContent=n+" €",document.getElementById("total-bar").style.width=e+"%"}function fetchDonation(){const n=new XMLHttpRequest;n.open("GET","fetch_donations.php?charityStreamId="+window.charityStreamId+(window.continuationToken?"&continuationToken="+window.continuationToken:"")+(window.currentAmount?"&currentAmount="+window.currentAmount:"")+(window.from?"&from="+window.from:""),!0),n.onload=(()=>{if(200===n.status){const e=JSON.parse(n.response);document.querySelector(".widget-donation-goal")&&updateDonationBar(),document.querySelector(".widget-alert-box")&&e.donations&&e.donations.length>0&&e.donations.forEach(n=>{displayAlertBox(n.pseudo,n.message,n.amount)}),window.currentAmount=e.amount,window.continuationToken=e.continuationToken}else console.error("Erreur lors de la récupération des données de donation:",n.response)}),n.send()}