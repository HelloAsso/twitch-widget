function displayAlertBox(e,n,o){n=n.substring(0,255),alertQueue.push({pseudo:e,message:n,amount:o}),isAlertActive||processAlertQueue()}function processAlertQueue(){if(0===alertQueue.length)return void(isAlertActive=!1);isAlertActive=!0;const e=alertQueue.shift(),{pseudo:n,message:o,amount:t}=e;var r=document.querySelector(".widget-alert-box");r.innerHTML="";var a=document.createElement("img");a.src=window.image,a.style.maxWidth="100%",a.classList.add("fade"),r.appendChild(a);let u=new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"});var s=document.createElement("p");s.innerHTML=window.message_template.replace("{pseudo}",n).replace("{message}",o).replace("{amount}",u.format(t/100)),s.style.marginTop="10px",s.classList.add("fade"),r.appendChild(s);var i=new Audio(window.sound);setTimeout(function(){a.classList.add("show"),s.classList.add("show"),i.volume=window.sound_volume,i.play()},100),setTimeout(function(){a.classList.remove("show"),s.classList.remove("show"),i.pause(),i.currentTime=0,r.innerHTML="",processAlertQueue()},window.alert_duration)}function updateDonationBar(){const e=window.currentAmount/100,n=Math.min(100,e/window.goalAmount*100);counterback.update(e),counterfront.update(e),document.querySelector("div.front").style["-webkit-clip-path"]="inset(0 "+(100-n)+"% 0 0 round 999px)"}function fetchDonation(){const e=new XMLHttpRequest;e.open("GET","fetch_donations.php?charityStreamId="+window.charityStreamId+(window.continuationToken?"&continuationToken="+window.continuationToken:"")+(window.currentAmount?"&currentAmount="+window.currentAmount:"")+(window.from?"&from="+window.from:""),!0),e.onload=(()=>{if(200===e.status){const n=JSON.parse(e.response);window.currentAmount=n.amount,window.continuationToken=n.continuationToken,document.querySelector(".progress")&&updateDonationBar(),document.querySelector(".widget-alert-box")&&n.donations&&n.donations.length>0&&n.donations.forEach(e=>{displayAlertBox(e.pseudo,e.message,e.amount)})}else console.error("Erreur lors de la récupération des données de donation:",e.response)}),e.send()}var alertQueue=[],isAlertActive=!1;const options={separator:" ",separator:" ",decimal:",",suffix:" €"};var counterback=new countUp.CountUp("back-goal-current",window.currentAmount,options),counterfront=new countUp.CountUp("front-goal-current",window.currentAmount,options);