function displayAlertBox(e,n,o){alertQueue.push({pseudo:e,message:n,amount:o}),isAlertActive||processAlertQueue()}function processAlertQueue(){if(0===alertQueue.length)return void(isAlertActive=!1);isAlertActive=!0;const e=alertQueue.shift(),{pseudo:n,message:o,amount:t}=e;var r=document.querySelector(".widget-alert-box"),a=r.innerHTML;r.innerHTML="";var i=document.createElement("img");i.src=window.image,i.style.maxWidth="100%",i.classList.add("fade"),r.appendChild(i);let s=new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"});var u=document.createElement("p");u.innerHTML=window.message_template.replace("{pseudo}",n).replace("{message}",o).replace("{amount}",s.format(t/100)),u.style.marginTop="10px",u.classList.add("fade"),r.appendChild(u),i.classList.add("show"),u.classList.add("show");var d=new Audio(window.sound);d.volume=window.sound_volume,d.play(),setTimeout(function(){i.classList.remove("show"),u.classList.remove("show"),d.pause(),d.currentTime=0,r.innerHTML=a,processAlertQueue()},window.alert_duration)}function updateDonationBar(){const e=window.currentAmount/100,n=Math.min(100,e/window.goalAmount*100);counter.update(e),document.getElementById("total-bar").style.width="calc("+n+"% - 8px)"}function fetchDonation(){const e=new XMLHttpRequest;e.open("GET","fetch_donations.php?charityStreamId="+window.charityStreamId+(window.continuationToken?"&continuationToken="+window.continuationToken:"")+(window.currentAmount?"&currentAmount="+window.currentAmount:"")+(window.from?"&from="+window.from:""),!0),e.onload=(()=>{if(200===e.status){const n=JSON.parse(e.response);document.querySelector(".widget-donation-goal")&&updateDonationBar(),document.querySelector(".widget-alert-box")&&n.donations&&n.donations.length>0&&n.donations.forEach(e=>{displayAlertBox(e.pseudo,e.message,e.amount)}),window.currentAmount=n.amount,window.continuationToken=n.continuationToken}else console.error("Erreur lors de la récupération des données de donation:",e.response)}),e.send()}var alertQueue=[],isAlertActive=!1;const options={separator:" ",separator:" ",decimal:",",suffix:" €"};var counter=new countUp.CountUp("goal-current",window.currentAmount,options);