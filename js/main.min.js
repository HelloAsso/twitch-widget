function displayAlertBox(e,o,n){alertQueue.push({pseudo:e,message:o,amount:n}),isAlertActive||processAlertQueue()}function processAlertQueue(){if(0===alertQueue.length)return void(isAlertActive=!1);isAlertActive=!0;const e=alertQueue.shift(),{pseudo:o,message:n,amount:t}=e;var r=document.querySelector(".widget-alert-box"),a=r.innerHTML;r.innerHTML="";var i=document.createElement("img");i.src=window.image,i.style.maxWidth="100%",i.classList.add("fade"),r.appendChild(i);let s=new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"});var u=document.createElement("p");u.innerHTML=window.message_template.replace("{pseudo}",o).replace("{message}",n).replace("{amount}",s.format(t/100)),u.style.marginTop="10px",u.classList.add("fade"),r.appendChild(u),setTimeout(function(){i.classList.add("show"),u.classList.add("show");var e=new Audio(window.sound);e.volume=window.sound_volume,e.play()},100),setTimeout(function(){i.classList.remove("show"),u.classList.remove("show"),audio.pause(),audio.currentTime=0,r.innerHTML=a,processAlertQueue()},window.alert_duration)}function updateDonationBar(){const e=window.currentAmount/100,o=Math.min(100,e/window.goalAmount*100);counter.update(e),document.getElementById("total-bar").style.width="calc("+o+"% - 8px)"}function fetchDonation(){const e=new XMLHttpRequest;e.open("GET","fetch_donations.php?charityStreamId="+window.charityStreamId+(window.continuationToken?"&continuationToken="+window.continuationToken:"")+(window.currentAmount?"&currentAmount="+window.currentAmount:"")+(window.from?"&from="+window.from:""),!0),e.onload=(()=>{if(200===e.status){const o=JSON.parse(e.response);document.querySelector(".widget-donation-goal")&&updateDonationBar(),document.querySelector(".widget-alert-box")&&o.donations&&o.donations.length>0&&o.donations.forEach(e=>{displayAlertBox(e.pseudo,e.message,e.amount)}),window.currentAmount=o.amount,window.continuationToken=o.continuationToken}else console.error("Erreur lors de la récupération des données de donation:",e.response)}),e.send()}var alertQueue=[],isAlertActive=!1;const options={separator:" ",separator:" ",decimal:",",suffix:" €"};var counter=new countUp.CountUp("goal-current",window.currentAmount,options);