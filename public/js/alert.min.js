function displayAlertBox(e,t,s){t=t.substring(0,255),alertQueue.push({pseudo:e,message:t,amount:s}),isAlertActive||processAlertQueue()}function processAlertQueue(){if(0===alertQueue.length)return void(isAlertActive=!1);isAlertActive=!0;const e=alertQueue.shift(),{pseudo:t,message:s,amount:o}=e;var a=document.querySelector(".widget-alert-box");let r;a.innerHTML="",window.image.endsWith(".mp4")?(r=document.createElement("video"),r.src=window.image,r.autoplay=!0,r.loop=!0,r.muted=!1,r.style.maxWidth="100%",r.classList.add("fade")):(r=document.createElement("img"),r.src=window.image,r.style.maxWidth="100%",r.classList.add("fade")),a.appendChild(r);let n=new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"});var i=document.createElement("p");i.innerHTML=window.message_template.replace("{pseudo}",t).replace("{message}",s).replace("{amount}",n.format(o/100)),i.style.marginTop="10px",i.classList.add("fade"),a.appendChild(i);var d=new Audio(window.sound);setTimeout(function(){r.classList.add("show"),i.classList.add("show"),d.volume=window.sound_volume,d.play()},100),setTimeout(function(){r.classList.remove("show"),i.classList.remove("show"),d.pause(),d.currentTime=0,a.innerHTML="",processAlertQueue()},window.alert_duration)}function fetch(){const e=new XMLHttpRequest;e.open("GET","/widget-stream-alert/"+window.charityStreamId+"/fetch",!0),e.onload=(()=>{if(200===e.status){const t=JSON.parse(e.response);t.donations.forEach(e=>{displayAlertBox(e.pseudo,e.message,e.amount)})}else console.error("Erreur lors de la récupération des données de donation:",e.response)}),e.send()}var alertQueue=[],isAlertActive=!1;